<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>환영합니다</title>
    <!-- GSAP 라이브러리 추가 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <style>
        .container {
            width: 80%;
            margin: 50px auto;
        }
        .welcome-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            opacity: 0;
            transform: translateY(-30px);
        }

        .welcome-banner h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s;
            opacity: 0;
            transform: translateY(30px);
        }

        .stat-card i {
            font-size: 40px;
            color: #667eea;
            margin-bottom: 15px;
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }

        .stat-detail {
            font-size: 14px;
            color: #28a745;
        }

        .recent-posts-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 40px;
            opacity: 0;
            transform: translateX(-30px);
        }

        .recent-posts-section h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .posts-list {
            margin-bottom: 20px;
        }

        .post-item {
            display: block;
            padding: 15px;
            border-bottom: 1px solid #eee;
            text-decoration: none;
            color: inherit;
            transition: background 0.2s;
        }

        .post-item:hover {
            background: #f8f9fa;
        }

        .post-item:last-child {
            border-bottom: none;
        }

        .post-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 8px;
            color: #333;
        }

        .post-meta {
            font-size: 13px;
            color: #666;
            display: flex;
            gap: 15px;
        }

        .post-meta i {
            margin-right: 5px;
        }

        .view-all-btn {
            display: inline-block;
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .view-all-btn:hover {
            text-decoration: underline;
        }

        .quick-links {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            opacity: 0;
            transform: translateX(30px);
        }

        .quick-links h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .links-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .quick-link-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 25px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 8px;
            text-decoration: none;
            color: #333;
            transition: transform 0.3s;
        }

        .quick-link-card i {
            font-size: 32px;
            margin-bottom: 10px;
            color: #667eea;
        }

        .no-posts {
            text-align: center;
            color: #999;
            padding: 20px;
        }
    </style>
</head>
<body>
    {% extends "menu.html" %}

    {% block title %}환영합니다{% endblock %}
    
    {% block additional_styles %}
    .container {
        width: 80%;
        margin: 50px auto;
    }
    /* 기존 스타일 유지 */
    {% endblock %}
    
    {% block content %}
    <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="flash-message {{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- 환영 배너 -->
        <div class="welcome-banner">
            <h1>EDL 재고관리 시스템에 오신 것을 환영합니다!</h1>
        </div>

        <!-- 빠른 통계 카드 -->
        <div class="stats-grid">
            <div class="stat-card">
                <i class="fas fa-boxes"></i>
                <div class="stat-number">{{ edl_total }}</div>
                <div class="stat-label">EDL-Doctor 재고</div>
                <div class="stat-detail">정상: {{ edl_normal }}개</div>
            </div>
            
            <div class="stat-card">
                <i class="fas fa-ring"></i>
                <div class="stat-number">{{ smartring_total }}</div>
                <div class="stat-label">SMARTRING 재고</div>
                <div class="stat-detail">정상: {{ smartring_normal }}개</div>
            </div>
            
            <div class="stat-card">
                <i class="fas fa-newspaper"></i>
                <div class="stat-number">{{ total_posts }}</div>
                <div class="stat-label">전체 게시글</div>
            </div>
            
            <div class="stat-card">
                <i class="fas fa-users"></i>
                <div class="stat-number">{{ total_users }}</div>
                <div class="stat-label">등록된 사용자</div>
            </div>
        </div>

        <!-- 최근 게시글 -->
        <div class="recent-posts-section">
            <h2>최근 게시글</h2>
            <div class="posts-list">
                {% if recent_posts %}
                    {% for post in recent_posts %}
                    <a href="{{ url_for('board_view', post_id=post.id) }}" class="post-item">
                        <div class="post-title">{{ post.title }}</div>
                        <div class="post-meta">
                            <span><i class="fas fa-user"></i> {{ post.author }}</span>
                            <span><i class="fas fa-calendar"></i> {{ post.created_at.strftime('%Y-%m-%d') }}</span>
                            <span><i class="fas fa-eye"></i> {{ post.views }}</span>
                        </div>
                    </a>
                    {% endfor %}
                {% else %}
                    <p class="no-posts">등록된 게시글이 없습니다.</p>
                {% endif %}
            </div>
            <a href="{{ url_for('board_list') }}" class="view-all-btn">전체 게시글 보기 →</a>
        </div>

        <!-- 빠른 링크 -->
        <div class="quick-links">
            <h2>바로가기</h2>
            <div class="links-grid">
                <a href="{{ url_for('edl_doctor') }}" class="quick-link-card">
                    <i class="fas fa-heartbeat"></i>
                    <span>EDL-Doctor 관리</span>
                </a>
                <a href="{{ url_for('smartring') }}" class="quick-link-card">
                    <i class="fas fa-ring"></i>
                    <span>SMARTRING 관리</span>
                </a>
                <a href="{{ url_for('board_list') }}" class="quick-link-card">
                    <i class="fas fa-clipboard"></i>
                    <span>게시판</span>
                </a>
                {% if current_user %}
                <a href="{{ url_for('board_write') }}" class="quick-link-card">
                    <i class="fas fa-pen"></i>
                    <span>글쓰기</span>
                </a>
                {% endif %}
            </div>
        </div>
    </div>

    <script>
        // GSAP 애니메이션
        document.addEventListener('DOMContentLoaded', function() {
            // 환영 배너 애니메이션
            gsap.to('.welcome-banner', {
                opacity: 1,
                y: 0,
                duration: 1,
                ease: 'power3.out'
            });

            // 통계 카드 순차 애니메이션
            gsap.to('.stat-card', {
                opacity: 1,
                y: 0,
                duration: 0.8,
                stagger: 0.15,
                ease: 'back.out(1.7)',
                delay: 0.3
            });

            // 최근 게시글 섹션 애니메이션
            gsap.to('.recent-posts-section', {
                opacity: 1,
                x: 0,
                duration: 0.8,
                ease: 'power2.out',
                delay: 0.8
            });

            // 빠른 링크 애니메이션
            gsap.to('.quick-links', {
                opacity: 1,
                x: 0,
                duration: 0.8,
                ease: 'power2.out',
                delay: 1
            });

            // 통계 카드 호버 효과
            document.querySelectorAll('.stat-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    gsap.to(this, {
                        y: -10,
                        scale: 1.05,
                        duration: 0.3,
                        ease: 'power2.out'
                    });
                });

                card.addEventListener('mouseleave', function() {
                    gsap.to(this, {
                        y: 0,
                        scale: 1,
                        duration: 0.3,
                        ease: 'power2.out'
                    });
                });
            });

            // 빠른 링크 카드 호버 효과
            document.querySelectorAll('.quick-link-card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    gsap.to(this, {
                        y: -5,
                        scale: 1.05,
                        duration: 0.3,
                        ease: 'power2.out'
                    });
                    
                    gsap.to(this.querySelector('i'), {
                        scale: 1.2,
                        rotation: 5,
                        duration: 0.3,
                        ease: 'back.out(2)'
                    });
                });

                card.addEventListener('mouseleave', function() {
                    gsap.to(this, {
                        y: 0,
                        scale: 1,
                        duration: 0.3,
                        ease: 'power2.out'
                    });
                    
                    gsap.to(this.querySelector('i'), {
                        scale: 1,
                        rotation: 0,
                        duration: 0.3,
                        ease: 'back.out(2)'
                    });
                });
            });

            // 게시글 아이템 호버 효과
            document.querySelectorAll('.post-item').forEach(item => {
                item.addEventListener('mouseenter', function() {
                    gsap.to(this, {
                        x: 5,
                        duration: 0.3,
                        ease: 'power2.out'
                    });
                });

                item.addEventListener('mouseleave', function() {
                    gsap.to(this, {
                        x: 0,
                        duration: 0.3,
                        ease: 'power2.out'
                    });
                });
            });

            // 숫자 카운트업 애니메이션
            document.querySelectorAll('.stat-number').forEach(element => {
                const finalValue = parseInt(element.textContent);
                gsap.from(element, {
                    textContent: 0,
                    duration: 2,
                    delay: 0.5,
                    ease: 'power1.out',
                    snap: { textContent: 1 },
                    onUpdate: function() {
                        element.textContent = Math.ceil(element.textContent);
                    }
                });
            });
        });

        // 로그인 폼 제출 처리
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            fetch('/login', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    username: document.getElementById('username').value,
                    password: document.getElementById('password').value
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    window.location.href = '/login_success' + '/' + data.userid;
                } else {
                    alert('아이디 또는 비밀번호가 올바르지 않습니다.');
                }
            });
        });
    </script>
    {% endblock %}
</body>
</html>